"use strict";(self.webpackChunkmiCartera=self.webpackChunkmiCartera||[]).push([[539],{6539:(C,m,n)=>{n.r(m),n.d(m,{default:()=>F});var e=n(4438),d=n(177),c=n(5601),i=n(9417),f=n(4796),p=n(3062),b=n(7935);n(3665);const g=s=>({"border-red-500":s});function v(s,u){1&s&&(e.j41(0,"p",20),e.EFF(1,"Correo inv\xe1lido."),e.k0s())}function _(s,u){1&s&&(e.j41(0,"p",20),e.EFF(1,"Debe tener al menos 6 caracteres."),e.k0s())}function w(s,u){if(1&s){const t=e.RV6();e.j41(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",24),e.qSk(),e.j41(4,"svg",25),e.nrm(5,"path",26),e.k0s()()(),e.joV(),e.j41(6,"h3",27),e.EFF(7,"Error en Inicio de Sesi\xf3n"),e.k0s(),e.j41(8,"p",28),e.EFF(9),e.k0s(),e.j41(10,"button",29),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.closeModal())}),e.EFF(11," Cerrar "),e.k0s()()()}if(2&s){const t=e.XpG();e.R7$(9),e.JRh(t.errorMessage)}}function E(s,u){if(1&s&&(e.j41(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",30),e.qSk(),e.j41(4,"svg",31),e.nrm(5,"path",32),e.k0s()()(),e.joV(),e.j41(6,"h3",27),e.EFF(7),e.k0s()()()),2&s){const t=e.XpG();e.R7$(7),e.SpI("\xa1Bienvenido, ",t.welcomeName,"!")}}let F=(()=>{class s{constructor(){this.fb=(0,e.WQX)(i.ok),this.router=(0,e.WQX)(c.Ix),this.authService=(0,e.WQX)(f.u),this.dateService=(0,e.WQX)(p.k),this.showPassword=!1,this.showModal=!1,this.showSuccessModal=!1,this.errorMessage="",this.welcomeName="",this.loginForm=this.fb.group({email:["",[i.k0.required,i.k0.email]],password:["",[i.k0.required,i.k0.minLength(6)]]})}ngOnInit(){b.A.auth().getRedirectResult().then(t=>{t&&t.user&&(this.welcomeName=t.user.displayName||"Usuario",this.showSuccessModal=!0,setTimeout(()=>{this.router.navigate(["app/home"])},1e3))}).catch(t=>{console.error("Error en getRedirectResult:",t)})}isInvalid(t){const r=this.loginForm.get(t);return!(!r||!r.invalid||!r.dirty&&!r.touched)}onSubmit(){if(this.loginForm.valid){const{email:t,password:r}=this.loginForm.value;this.authService.login(t,r).subscribe({next:o=>{const a=o.localId;this.authService.getUserData(a).subscribe(x=>{this.showWelcomeModal(x?.nombre||"");const M=["Reserv\xe1 al menos el 10% de tus ingresos como ahorro.","Evit\xe1 gastos peque\xf1os repetitivos, pueden sumar mucho.","Asign\xe1 metas a tus ahorros: eso te motiva m\xe1s."];this.authService.getUserNotifications(a).subscribe(h=>{const k=h?Object.values(h).map(l=>l.mensaje):[];M.forEach(l=>{k.includes(l)||this.authService.addNotification(a,l).subscribe()})})})},error:o=>{this.showErrorModal(this.getFirebaseErrorMessage(o))}})}}showErrorModal(t){this.errorMessage=t,this.showModal=!0}closeModal(){this.showModal=!1}showWelcomeModal(t){this.welcomeName=t,this.showSuccessModal=!0,this.dateService.resetToCurrentDate(),setTimeout(()=>{this.showSuccessModal=!1,this.router.navigate(["app/home"])},1e3)}getFirebaseErrorMessage(t){switch(t){case"EMAIL_NOT_FOUND":case"INVALID_PASSWORD":return"Correo o contrase\xf1a incorrectos.";case"USER_DISABLED":return"Este usuario ha sido deshabilitado.";default:return"Ha ocurrido un error inesperado."}}togglePasswordVisibility(){this.showPassword=!this.showPassword}onLoginWithGoogle(){this.authService.loginWithGoogle()}static#e=this.\u0275fac=function(r){return new(r||s)};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["app-login"]],standalone:!0,features:[e.aNF],decls:30,vars:14,consts:[[1,"flex","justify-center","items-center","h-screen","w-screen","bg-gradient-to-r","from-purple-900","to-sky-900"],[1,"bg-white","p-10","rounded-lg","shadow-lg","w-full","max-w-md"],[1,"text-center","text-3xl","font-bold","text-gray-700","mb-6"],[3,"ngSubmit","formGroup"],[1,"mb-6"],["for","email",1,"block","text-gray-600","text-sm","font-semibold"],["type","email","id","email","formControlName","email",1,"w-full","px-4","py-3","mt-2","border","rounded-lg","focus:ring","focus:ring-blue-300",3,"ngClass"],["class","text-red-500 text-xs mt-1",4,"ngIf"],[1,"mb-6","relative"],["for","password",1,"block","text-gray-600","text-sm","font-semibold"],["id","password","formControlName","password",1,"w-full","px-4","py-3","mt-2","border","rounded-lg","focus:ring","focus:ring-blue-300","pr-10",3,"type","ngClass"],["type","button",1,"absolute","right-3","top-10","text-gray-500","focus:outline-none",3,"click"],[1,"material-icons"],["type","submit",1,"w-full","bg-blue-500","text-white","py-3","rounded-lg","shadow-md","hover:bg-blue-600","transition","disabled:opacity-50",3,"disabled"],["type","button",1,"w-full","bg-white","text-black","border","border-gray-300","py-3","rounded-full","shadow-md","hover:bg-gray-100","transition","mt-4","flex","items-center","justify-center","gap-3",3,"click"],["src","https://developers.google.com/identity/images/g-logo.png","alt","Google logo",1,"w-6","h-6"],[1,"font-semibold"],[1,"text-center","text-sm","text-gray-500","mt-6"],["routerLink","/register",1,"text-blue-500","font-semibold","hover:underline"],["class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],[1,"text-red-500","text-xs","mt-1"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-white","p-6","rounded-lg","shadow-lg","max-w-sm","w-full","relative"],[1,"flex","justify-center","mb-4"],[1,"w-16","h-16","flex","items-center","justify-center","bg-red-100","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-8","w-8","text-red-500"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3-10a1 1 0 00-1.414-1.414L10 8.586 8.414 7A1 1 0 007 8.414L8.586 10 7 11.586A1 1 0 108.414 13L10 11.414l1.586 1.586A1 1 0 1013 11.586L11.414 10 13 8.414A1 1 0 0013 8z","clip-rule","evenodd"],[1,"text-xl","font-bold","text-gray-800","mb-4","text-center"],[1,"text-gray-600","text-center"],[1,"mt-4","w-full","bg-red-500","text-white","py-2","rounded-lg","hover:bg-red-600","transition",3,"click"],[1,"w-16","h-16","flex","items-center","justify-center","bg-green-100","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-8","w-8","text-green-500"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 000 16zm3-10l-4 4-2-2a1 1 0 00-1.414 1.414L10 14l5-5a1 1 0 00-1.414-1.414z","clip-rule","evenodd"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3,"Iniciar Sesi\xf3n"),e.k0s(),e.j41(4,"form",3),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(5,"div",4)(6,"label",5),e.EFF(7,"Correo Electr\xf3nico"),e.k0s(),e.nrm(8,"input",6),e.DNE(9,v,2,0,"p",7),e.k0s(),e.j41(10,"div",8)(11,"label",9),e.EFF(12,"Contrase\xf1a"),e.k0s(),e.nrm(13,"input",10),e.j41(14,"button",11),e.bIt("click",function(){return o.togglePasswordVisibility()}),e.j41(15,"span",12),e.EFF(16),e.k0s()(),e.DNE(17,_,2,0,"p",7),e.k0s(),e.j41(18,"button",13),e.EFF(19," Iniciar Sesi\xf3n "),e.k0s(),e.j41(20,"button",14),e.bIt("click",function(){return o.onLoginWithGoogle()}),e.nrm(21,"img",15),e.j41(22,"span",16),e.EFF(23,"Iniciar sesi\xf3n con Google"),e.k0s()(),e.j41(24,"p",17),e.EFF(25," \xbfNo tienes cuenta? "),e.j41(26,"a",18),e.EFF(27,"Reg\xedstrate"),e.k0s()()()()(),e.DNE(28,w,12,1,"div",19)(29,E,8,1,"div",19)),2&r&&(e.R7$(4),e.Y8G("formGroup",o.loginForm),e.R7$(4),e.Y8G("ngClass",e.eq3(10,g,o.isInvalid("email"))),e.R7$(),e.Y8G("ngIf",o.isInvalid("email")),e.R7$(4),e.Y8G("type",o.showPassword?"text":"password")("ngClass",e.eq3(12,g,o.isInvalid("password"))),e.R7$(3),e.SpI(" ",o.showPassword?"visibility_off":"visibility"," "),e.R7$(),e.Y8G("ngIf",o.isInvalid("password")),e.R7$(),e.Y8G("disabled",o.loginForm.invalid),e.R7$(10),e.Y8G("ngIf",o.showModal),e.R7$(),e.Y8G("ngIf",o.showSuccessModal))},dependencies:[d.MD,d.YU,d.bT,c.iI,c.Wk,i.X1,i.qT,i.me,i.BC,i.cb,i.j4,i.JD]})}return s})()}}]);