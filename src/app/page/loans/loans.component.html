<div class="mb-6 grid grid-cols-1 xl:grid-cols-2 gap-6">
  <div class="relative flex flex-col bg-white rounded-xl shadow-lg overflow-hidden xl:col-span-2 border border-gray-200">

    <!-- Encabezado -->
    <div class="flex items-center justify-between p-6 bg-gradient-to-r from-blue-700 to-teal-500 text-white rounded-t-xl shadow-md">
      <div>
        <h6 class="text-xl font-bold tracking-wide">Pr√©stamos</h6>
        <p class="text-sm flex items-center gap-2 opacity-90">
          <strong>Estado de Pr√©stamos</strong>
        </p>
      </div>
    </div>

    <!-- Tabla -->
    <div class="overflow-x-auto">
      <table class="w-full min-w-[640px] border-collapse">
        <thead class="bg-gray-100">
          <tr class="border-b">
            <th class="py-4 px-6 text-left text-xs font-semibold uppercase text-gray-600">Nombre Deudor</th>
            <th class="py-4 px-6 text-center text-xs font-semibold uppercase text-gray-600">Fecha de Pr√©stamo</th>
            <th class="py-4 px-6 text-center text-xs font-semibold uppercase text-gray-600">Fecha de Pago</th>
            <th class="py-4 px-6 text-right text-xs font-semibold uppercase text-gray-600">Valor</th>
            <th class="py-4 px-6 text-center text-xs font-semibold uppercase text-gray-600">Estado</th>
            <th class="py-4 px-6 text-center text-xs font-semibold uppercase text-gray-600">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let loan of loans; let i = index" class="border-b transition duration-300 hover:bg-gray-50">
            <td class="py-4 px-6 font-semibold">{{ loan.deudor }}</td>
            <td class="py-4 px-6 text-center">{{ loan.fecha_prestamo }}</td>
            <td class="py-4 px-6 text-center">{{ loan.fecha_pago }}</td>
            <td class="py-4 px-6 text-right font-semibold text-teal-600">
              ${{ formatCurrency(loan.valor) }}
            </td>
            <td class="py-4 px-6 text-center">
              <button (click)="togglePaymentStatus(loan)"
                class="px-3 py-1 text-xs font-semibold rounded-full transition duration-300"
                [ngClass]="loan.estado === 'Pagado' ? 'bg-green-500 text-white hover:bg-green-600' : 'bg-red-500 text-white hover:bg-red-600'">
                {{ loan.estado }}
              </button>
            </td>
            <td class="py-4 px-6 text-center">
              <button (click)="openEditModal(loan.id)" class="text-blue-600 mr-2">‚úèÔ∏è</button>
              <button (click)="deleteLoan(loan.id)" class="text-red-600">üóëÔ∏è</button>
            </td>
          </tr>

          <!-- Total Pr√©stamos Pendientes -->
          <tr class="bg-teal-50 font-bold text-teal-900">
            <td class="py-4 px-6 text-left">Total Pr√©stamos Pendientes</td>
            <td class="py-4 px-6"></td>
            <td class="py-4 px-6"></td>
            <td class="py-4 px-6 text-right">
              ${{ formatCurrency(getTotalPendingLoans()) }}
            </td>
            <td class="py-4 px-6"></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Bot√≥n para agregar pr√©stamo -->
    <div class="flex justify-end p-4">
      <button (click)="openModal()" class="bg-blue-600 text-white px-4 py-2 rounded-md shadow-md hover:bg-teal-500 transition">
        Agregar Pr√©stamo +
      </button>
    </div>

    <!-- Modal para agregar pr√©stamo -->
    <div *ngIf="isModalOpen" class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50">
      <div class="bg-white p-6 rounded-lg shadow-lg w-96">
        <h2 class="text-xl font-bold mb-4">Agregar Nuevo Pr√©stamo</h2>

        <label class="block mb-2">Nombre Deudor:</label>
        <input type="text" [(ngModel)]="newLoan.deudor" class="w-full p-2 border rounded-md mb-3">

        <label class="block mb-2">Fecha de Pr√©stamo:</label>
        <input type="date" [(ngModel)]="newLoan.fecha_prestamo" class="w-full p-2 border rounded-md mb-3">

        <label class="block mb-2">Fecha de Pago:</label>
        <input type="date" [(ngModel)]="newLoan.fecha_pago" class="w-full p-2 border rounded-md mb-3">

        <label class="block mb-2">Valor:</label>
        <input type="number" [(ngModel)]="newLoan.valor" class="w-full p-2 border rounded-md mb-3">

        <div class="flex justify-end gap-2">
          <button (click)="closeModal()" class="px-4 py-2 border rounded-md">Cancelar</button>
          <button (click)="addLoan()" class="px-4 py-2 bg-green-500 text-white rounded-md">Agregar</button>
        </div>
      </div>
    </div>

    <!-- Modal para editar pr√©stamo -->
    <div *ngIf="isEditModalOpen" class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50">
      <div class="bg-white p-6 rounded-lg shadow-lg w-96">
        <h2 class="text-xl font-bold mb-4">Editar Pr√©stamo</h2>

        <label class="block mb-2">Nombre Deudor:</label>
        <input type="text" [(ngModel)]="editedLoan.deudor" class="w-full p-2 border rounded-md mb-3">

        <label class="block mb-2">Fecha de Pr√©stamo:</label>
        <input type="date" [(ngModel)]="editedLoan.fecha_prestamo" class="w-full p-2 border rounded-md mb-3">

        <label class="block mb-2">Fecha de Pago:</label>
        <input type="date" [(ngModel)]="editedLoan.fecha_pago" class="w-full p-2 border rounded-md mb-3">

        <label class="block mb-2">Valor:</label>
        <input type="number" [(ngModel)]="editedLoan.valor" class="w-full p-2 border rounded-md mb-3">

        <div class="flex justify-end gap-2">
          <button (click)="closeEditModal()" class="px-4 py-2 border rounded-md">Cancelar</button>
          <button (click)="saveEditedLoan()" class="px-4 py-2 bg-green-500 text-white rounded-md">Guardar</button>
        </div>
      </div>
    </div>
  </div>
</div>
